import{N as be,S as de,h as f,U as pe,z as ge,V as Y,m as W,W as C,v as Ee,X as De,C as ze,J as _e,L as ee,M as Fe,d as P,Y as Ue,B as U,A as u}from"./index-CQIyDd2_.js";import{v as Ie,u as Xe,c as ce,h as Ye,b as Qe}from"./use-dark-bEKcnp87.js";import{h as je,i as Ne,j as Re,T as te,k as I}from"./QScrollArea-kJ0XkwaN.js";import{u as Ke}from"./use-timeout-BWaq1J2s.js";function Je(e,a,s){let n;function c(){n!==void 0&&(de.remove(n),n=void 0)}return be(()=>{e.value===!0&&c()}),{removeFromHistory:c,addToHistory(){n={condition:()=>s.value===!0,handler:a},de.add(n)}}}const Ge={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},Ze=["beforeShow","show","beforeHide","hide"];function et({showing:e,canShow:a,hideOnRouteChange:s,handleShow:n,handleHide:c,processOnMount:v}){const h=ge(),{props:w,emit:p,proxy:D}=h;let l;function $(r){e.value===!0?d(r):g(r)}function g(r){if(w.disable===!0||r?.qAnchorHandled===!0||a!==void 0&&a(r)!==!0)return;const T=w["onUpdate:modelValue"]!==void 0;T===!0&&(p("update:modelValue",!0),l=r,Y(()=>{l===r&&(l=void 0)})),(w.modelValue===null||T===!1)&&x(r)}function x(r){e.value!==!0&&(e.value=!0,p("beforeShow",r),n!==void 0?n(r):p("show",r))}function d(r){if(w.disable===!0)return;const T=w["onUpdate:modelValue"]!==void 0;T===!0&&(p("update:modelValue",!1),l=r,Y(()=>{l===r&&(l=void 0)})),(w.modelValue===null||T===!1)&&q(r)}function q(r){e.value!==!1&&(e.value=!1,p("beforeHide",r),c!==void 0?c(r):p("hide",r))}function m(r){w.disable===!0&&r===!0?w["onUpdate:modelValue"]!==void 0&&p("update:modelValue",!1):r===!0!==e.value&&(r===!0?x:q)(l)}f(()=>w.modelValue,m),s!==void 0&&Ie(h)===!0&&f(()=>D.$route.fullPath,()=>{s.value===!0&&e.value===!0&&d()}),v===!0&&pe(()=>{m(w.modelValue)});const i={show:g,hide:d,toggle:$};return Object.assign(D,i),i}let O=0,le,ae,E,oe=!1,fe,ve,me,B=null;function tt(e){lt(e)&&Ee(e)}function lt(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const a=De(e),s=e.shiftKey&&!e.deltaX,n=!s&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),c=s||n?e.deltaY:e.deltaX;for(let v=0;v<a.length;v++){const h=a[v];if(Re(h,n))return n?c<0&&h.scrollTop===0?!0:c>0&&h.scrollTop+h.clientHeight===h.scrollHeight:c<0&&h.scrollLeft===0?!0:c>0&&h.scrollLeft+h.clientWidth===h.scrollWidth}return!0}function he(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function X(e){oe!==!0&&(oe=!0,requestAnimationFrame(()=>{oe=!1;const{height:a}=e.target,{clientHeight:s,scrollTop:n}=document.scrollingElement;(E===void 0||a!==window.innerHeight)&&(E=s-a,document.scrollingElement.scrollTop=n),n>E&&(document.scrollingElement.scrollTop-=Math.ceil((n-E)/8))}))}function we(e){const a=document.body,s=window.visualViewport!==void 0;if(e==="add"){const{overflowY:n,overflowX:c}=window.getComputedStyle(a);le=je(window),ae=Ne(window),fe=a.style.left,ve=a.style.top,me=window.location.href,a.style.left=`-${le}px`,a.style.top=`-${ae}px`,c!=="hidden"&&(c==="scroll"||a.scrollWidth>window.innerWidth)&&a.classList.add("q-body--force-scrollbar-x"),n!=="hidden"&&(n==="scroll"||a.scrollHeight>window.innerHeight)&&a.classList.add("q-body--force-scrollbar-y"),a.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,W.is.ios===!0&&(s===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",X,C.passiveCapture),window.visualViewport.addEventListener("scroll",X,C.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",he,C.passiveCapture))}W.is.desktop===!0&&W.is.mac===!0&&window[`${e}EventListener`]("wheel",tt,C.notPassive),e==="remove"&&(W.is.ios===!0&&(s===!0?(window.visualViewport.removeEventListener("resize",X,C.passiveCapture),window.visualViewport.removeEventListener("scroll",X,C.passiveCapture)):window.removeEventListener("scroll",he,C.passiveCapture)),a.classList.remove("q-body--prevent-scroll"),a.classList.remove("q-body--force-scrollbar-x"),a.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,a.style.left=fe,a.style.top=ve,window.location.href===me&&window.scrollTo(le,ae),E=void 0)}function at(e){let a="add";if(e===!0){if(O++,B!==null){clearTimeout(B),B=null;return}if(O>1)return}else{if(O===0||(O--,O>0))return;if(a="remove",W.is.ios===!0&&W.is.nativeMobile===!0){B!==null&&clearTimeout(B),B=setTimeout(()=>{we(a),B=null},100);return}}we(a)}function ot(){let e;return{preventBodyScroll(a){a!==e&&(e!==void 0||a===!0)&&(e=a,at(a))}}}const ye=150,dt=ze({name:"QDrawer",inheritAttrs:!1,props:{...Ge,...Xe,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...Ze,"onLayout","miniState"],setup(e,{slots:a,emit:s,attrs:n}){const c=ge(),{proxy:{$q:v}}=c,h=Qe(e,v),{preventBodyScroll:w}=ot(),{registerTimeout:p,removeTimeout:D}=Ke(),l=_e(Fe,ee);if(l===ee)return console.error("QDrawer needs to be child of QLayout"),ee;let $,g=null,x;const d=P(e.behavior==="mobile"||e.behavior!=="desktop"&&l.totalWidth.value<=e.breakpoint),q=u(()=>e.mini===!0&&d.value!==!0),m=u(()=>q.value===!0?e.miniWidth:e.width),i=P(e.showIfAbove===!0&&d.value===!1?!0:e.modelValue===!0),r=u(()=>e.persistent!==!0&&(d.value===!0||qe.value===!0));function T(t,o){if(Te(),t!==!1&&l.animate(),b(0),d.value===!0){const y=l.instances[_.value];y?.belowBreakpoint===!0&&y.hide(!1),S(1),l.isContainer.value!==!0&&w(!0)}else S(0),t!==!1&&J(!1);p(()=>{t!==!1&&J(!0),o!==!0&&s("show",t)},ye)}function re(t,o){ke(),t!==!1&&l.animate(),S(0),b(V.value*m.value),G(),o!==!0?p(()=>{s("hide",t)},ye):D()}const{show:Q,hide:H}=et({showing:i,hideOnRouteChange:r,handleShow:T,handleHide:re}),{addToHistory:Te,removeFromHistory:ke}=Je(i,H,r),z={belowBreakpoint:d,hide:H},k=u(()=>e.side==="right"),V=u(()=>(v.lang.rtl===!0?-1:1)*(k.value===!0?1:-1)),ie=P(0),M=P(!1),j=P(!1),ne=P(m.value*V.value),_=u(()=>k.value===!0?"left":"right"),N=u(()=>i.value===!0&&d.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:m.value:0),R=u(()=>e.overlay===!0||e.miniToOverlay===!0||l.view.value.indexOf(k.value?"R":"L")!==-1||v.platform.is.ios===!0&&l.isContainer.value===!0),A=u(()=>e.overlay===!1&&i.value===!0&&d.value===!1),qe=u(()=>e.overlay===!0&&i.value===!0&&d.value===!1),Se=u(()=>"fullscreen q-drawer__backdrop"+(i.value===!1&&M.value===!1?" hidden":"")),Le=u(()=>({backgroundColor:`rgba(0,0,0,${ie.value*.4})`})),ue=u(()=>k.value===!0?l.rows.value.top[2]==="r":l.rows.value.top[0]==="l"),xe=u(()=>k.value===!0?l.rows.value.bottom[2]==="r":l.rows.value.bottom[0]==="l"),Ce=u(()=>{const t={};return l.header.space===!0&&ue.value===!1&&(R.value===!0?t.top=`${l.header.offset}px`:l.header.space===!0&&(t.top=`${l.header.size}px`)),l.footer.space===!0&&xe.value===!1&&(R.value===!0?t.bottom=`${l.footer.offset}px`:l.footer.space===!0&&(t.bottom=`${l.footer.size}px`)),t}),Be=u(()=>{const t={width:`${m.value}px`,transform:`translateX(${ne.value}px)`};return d.value===!0?t:Object.assign(t,Ce.value)}),Ve=u(()=>"q-drawer__content fit "+(l.isContainer.value!==!0?"scroll":"overflow-auto")),Me=u(()=>`q-drawer q-drawer--${e.side}`+(j.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(h.value===!0?" q-drawer--dark q-dark":"")+(M.value===!0?" no-transition":i.value===!0?"":" q-layout--prevent-focus")+(d.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${q.value===!0?"mini":"standard"}`+(R.value===!0||A.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(ue.value===!0?" q-drawer--top-padding":""))),Pe=u(()=>{const t=v.lang.rtl===!0?e.side:_.value;return[[te,Ae,void 0,{[t]:!0,mouse:!0}]]}),We=u(()=>{const t=v.lang.rtl===!0?_.value:e.side;return[[te,se,void 0,{[t]:!0,mouse:!0}]]}),$e=u(()=>{const t=v.lang.rtl===!0?_.value:e.side;return[[te,se,void 0,{[t]:!0,mouse:!0,mouseAllDir:!0}]]});function K(){Oe(d,e.behavior==="mobile"||e.behavior!=="desktop"&&l.totalWidth.value<=e.breakpoint)}f(d,t=>{t===!0?($=i.value,i.value===!0&&H(!1)):e.overlay===!1&&e.behavior!=="mobile"&&$!==!1&&(i.value===!0?(b(0),S(0),G()):Q(!1))}),f(()=>e.side,(t,o)=>{l.instances[o]===z&&(l.instances[o]=void 0,l[o].space=!1,l[o].offset=0),l.instances[t]=z,l[t].size=m.value,l[t].space=A.value,l[t].offset=N.value}),f(l.totalWidth,()=>{(l.isContainer.value===!0||document.qScrollPrevented!==!0)&&K()}),f(()=>e.behavior+e.breakpoint,K),f(l.isContainer,t=>{i.value===!0&&w(t!==!0),t===!0&&K()}),f(l.scrollbarWidth,()=>{b(i.value===!0?0:void 0)}),f(N,t=>{L("offset",t)}),f(A,t=>{s("onLayout",t),L("space",t)}),f(k,()=>{b()}),f(m,t=>{b(),Z(e.miniToOverlay,t)}),f(()=>e.miniToOverlay,t=>{Z(t,m.value)}),f(()=>v.lang.rtl,()=>{b()}),f(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(He(),l.animate())}),f(q,t=>{s("miniState",t)});function b(t){t===void 0?Y(()=>{t=i.value===!0?0:m.value,b(V.value*t)}):(l.isContainer.value===!0&&k.value===!0&&(d.value===!0||Math.abs(t)===m.value)&&(t+=V.value*l.scrollbarWidth.value),ne.value=t)}function S(t){ie.value=t}function J(t){const o=t===!0?"remove":l.isContainer.value!==!0?"add":"";o!==""&&document.body.classList[o]("q-body--drawer-toggle")}function He(){g!==null&&clearTimeout(g),c.proxy&&c.proxy.$el&&c.proxy.$el.classList.add("q-drawer--mini-animate"),j.value=!0,g=setTimeout(()=>{g=null,j.value=!1,c?.proxy?.$el?.classList.remove("q-drawer--mini-animate")},150)}function Ae(t){if(i.value!==!1)return;const o=m.value,y=I(t.distance.x,0,o);if(t.isFinal===!0){y>=Math.min(75,o)===!0?Q():(l.animate(),S(0),b(V.value*o)),M.value=!1;return}b((v.lang.rtl===!0?k.value!==!0:k.value)?Math.max(o-y,0):Math.min(0,y-o)),S(I(y/o,0,1)),t.isFirst===!0&&(M.value=!0)}function se(t){if(i.value!==!0)return;const o=m.value,y=t.direction===e.side,F=(v.lang.rtl===!0?y!==!0:y)?I(t.distance.x,0,o):0;if(t.isFinal===!0){Math.abs(F)<Math.min(75,o)===!0?(l.animate(),S(1),b(0)):H(),M.value=!1;return}b(V.value*F),S(I(1-F/o,0,1)),t.isFirst===!0&&(M.value=!0)}function G(){w(!1),J(!0)}function L(t,o){l.update(e.side,t,o)}function Oe(t,o){t.value!==o&&(t.value=o)}function Z(t,o){L("size",t===!0?e.miniWidth:o)}return l.instances[e.side]=z,Z(e.miniToOverlay,m.value),L("space",A.value),L("offset",N.value),e.showIfAbove===!0&&e.modelValue!==!0&&i.value===!0&&e["onUpdate:modelValue"]!==void 0&&s("update:modelValue",!0),pe(()=>{s("onLayout",A.value),s("miniState",q.value),$=e.showIfAbove===!0;const t=()=>{(i.value===!0?T:re)(!1,!0)};if(l.totalWidth.value!==0){Y(t);return}x=f(l.totalWidth,()=>{x(),x=void 0,i.value===!1&&e.showIfAbove===!0&&d.value===!1?Q(!1):t()})}),be(()=>{x?.(),g!==null&&(clearTimeout(g),g=null),i.value===!0&&G(),l.instances[e.side]===z&&(l.instances[e.side]=void 0,L("size",0),L("offset",0),L("space",!1))}),()=>{const t=[];d.value===!0&&(e.noSwipeOpen===!1&&t.push(Ue(U("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),Pe.value)),t.push(ce("div",{ref:"backdrop",class:Se.value,style:Le.value,"aria-hidden":"true",onClick:H},void 0,"backdrop",e.noSwipeBackdrop!==!0&&i.value===!0,()=>$e.value)));const o=q.value===!0&&a.mini!==void 0,y=[U("div",{...n,key:""+o,class:[Ve.value,n.class]},o===!0?a.mini():Ye(a.default))];return e.elevated===!0&&i.value===!0&&y.push(U("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),t.push(ce("aside",{ref:"content",class:Me.value,style:Be.value},y,"contentclose",e.noSwipeClose!==!0&&d.value===!0,()=>We.value)),U("div",{class:"q-drawer-container"},t)}}});export{dt as Q};
